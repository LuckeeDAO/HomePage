<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>项目总览</title>
    <style>
        body {
            max-width: 860px;
            margin: 32px auto;
            padding: 0 16px;
            font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            line-height: 1.6;
            color: #1f2937;
        }
        pre { background:#f8fafc; padding:12px; overflow:auto; border-radius:6px; }
        code { background:#f1f5f9; padding:2px 4px; border-radius:4px; }
        h1,h2,h3,h4,h5,h6 { line-height:1.25; }
        a { color:#2563eb; text-decoration:none; }
        a:hover { text-decoration:underline; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #e5e7eb; padding: 8px; }
        blockquote { margin: 0; padding-left: 1em; border-left: 4px solid #e5e7eb; color:#6b7280; }
    </style>
</head>
<body>
<h1>基于比特承诺模型的去中心化投票系统 - 项目总览</h1>
<p>> 用词规范：请参阅《[项目术语表](项目术语表.md)》以确保术语统一。</p>
<br/>
<h2>项目简介</h2>
<br/>
<p>> 📖 **项目总览说明**：本文档是项目的详细概述，包含完整的系统介绍、技术架构、开发计划和风险评估。如果您需要快速了解项目，请先阅读[README.md](../README.md)。</p>
<br/>
<p>本项目旨在构建一个基于比特承诺模型的去中心化决策投票系统，结合Rust WebAssembly高性能计算与区块链技术的不可篡改特性，支持大规模决策场景。系统通过密码学技术确保决策人偏好投票的隐私性，利用区块链保证数据完整性，实现真正去中心化的决策机制。</p>
<br/>
<h3>我们对“去中心化”的定义与五大原则</h3>
<p>- **分散与平等**：每个参与者的决策权形式上完全平等，对结果影响同等重要。</p>
<p>- **全员一致性共识**：任何结果均由全体参与者偏好叠加产生，无外部少数裁决权。</p>
<p>- **抗合谋与抗操纵**：协议与规则防止任何规模子集（含51%/99%）通过联合行动主导/篡改结果。</p>
<p>- **偏好显示自由性**：任何参与者不能通过伪造偏好获得绝对额外收益（博弈不可被单点操纵）。</p>
<p>- **透明与可验证**：提案、投票与决策过程对全体参与者透明，且人人可独立验证结果真实性与合法性。</p>
<br/>
<p>> 范围声明（Phase 1）：第一期仅支持去中心化抽奖（n选1、n选k）。去中心化彩票、分配、治理等其他应用场景纳入后续迭代。</p>
<br/>
<p>去中心化决策投票的核心特征是：决策结果不依赖任何一个人或者一部分人，其结果包含了全体决策人的偏好汇总，任何一个人的投票结果都会影响最后的结果。每个决策人的偏好用整数表示，系统通过透明且可验证的计算过程，汇总所有人的偏好，得出最终的决策结果。</p>
<br/>
<h3>决策类型统一术语与分类</h3>
<br/>
<p>- 概念定位：以下类型均为场景无关的“系统内置NFT类型”。应用场景通过选择对应的NFT类型获得能力。</p>
<p>- 按结果基数：</p>
<p>  - 单目标决策：每次仅产生一个获胜结果（例：单一中奖、单提案通过）。</p>
<p>  - 多目标决策：一次产生多个互不冲突的获胜结果（例：从n选k）。</p>
<p>- 按资源属性（分配/治理）：</p>
<p>  - 竞用性资源决策：有限且排他（名额/额度等）。</p>
<p>  - 非竞用性资源决策：非排他，可并行满足（公共品偏好）。</p>
<p>- 扩展性：通过NFT类型抽象承载，未来可新增更多决策类型。</p>
<br/>
<p>> 场景到NFT类型映射（示例）：</p>
<p>> - 抽奖：单目标决策 / 多目标决策</p>
<p>> - 彩票：多等级决策</p>
<p>> - 盲盒、游戏发牌：多等级决策</p>
<p>> - 资源分配：竞用性资源决策</p>
<p>> - 治理：非竞用性资源决策</p>
<br/>
<p>#### 具体应用场景：去中心化抽奖</p>
<p>以去中心化抽奖为例，系统的工作流程如下：</p>
<p>1. **参与者注册**：每个抽奖参与者通过数字身份注册</p>
<p>2. **提交随机数**：每个参与者提交一个整数作为自己的随机数</p>
<p>3. **隐私保护**：使用比特承诺协议保护每个参与者的随机数不被泄露</p>
<p>4. **结果计算**：系统累加所有参与者的整数之和，并对投票总人数进行取余</p>
<p>5. **结果验证**：最终得到的余数作为抽奖结果，整个过程透明可验证</p>
<br/>
<p>**具体示例**：</p>
<p>- 有5个参与者，分别提交整数[3, 7, 2, 9, 1]</p>
<p>- 总和为22，对5取余得到2</p>
<p>- 抽奖结果为2号参与者（索引从0开始）</p>
<p>- 任何人都可以验证计算过程：22 % 5 = 2 ✓</p>
<br/>
<p>**技术优势**：</p>
<p>- **公平性**：每个参与者的随机数都会影响最终结果</p>
<p>- **透明性**：计算过程完全公开可验证</p>
<p>- **防作弊**：通过密码学技术防止参与者操纵结果</p>
<p>- **去中心化**：不依赖任何中心化机构</p>
<br/>
<p>#### 系统功能：代币权限控制与NFT化投票</p>
<p>系统包含基于$LUCKEE代币持有量的权限控制和NFT化的投票资格管理功能：</p>
<br/>
<p>1. **代币权限控制**：</p>
<p>   - 只有持有$LUCKEE代币的账户才可以创建投票项目</p>
<p>   - 代币持有量决定用户权限等级（基础、创建者、管理员）</p>
<p>   - 支持代币质押和锁定机制</p>
<br/>
<p>2. **NFT化投票资格与投票项目属性接口**：</p>
<p>   - 投票项目管理是NFT管理的一个属性接口；项目配置均为NFT类型的全局参数（如时间窗口、偏好范围、是否抽奖/多目标等）</p>
<p>   - 投票资格以账户-`NFT`的持有关系为准；链上主要记录账户与`NFT`的关联信息与投票结果摘要</p>
<p>   - 详细投票数据（承诺/揭示明细、参与者列表、计算过程、证明与日志）存储在IPFS，链上保存其CID/哈希作为验证指针</p>
<p>   - 不同投票类型通过不同`NFT类型`承载与区分；支持`NFT`的转移和交易</p>
<br/>
<p>3. **多等级选择（多组多目标选择）**：</p>
<p>   - 支持设置不同的等级与每个等级的数量（等价多个 n 选 k 的组合）</p>
<p>   - 每个NFT拥有与选择相关的序号/结果关联</p>
<p>   - 智能序号分配算法</p>
<p>   - 支持批量选择结果生成</p>
<br/>
<h2>核心特性</h2>
<br/>
<h3>🔐 隐私保护</h3>
<p>- **比特承诺协议**：确保决策人偏好投票内容在揭示前对第三方不可见</p>
<p>- **端到端加密**：保护决策人数据安全</p>
<p>- **范围声明**：零知识证明不在本系统技术范围且不作为选项</p>
<br/>
<h3>⚡ 高性能</h3>
<p>- **Rust WebAssembly**：服务器端高性能计算</p>
<p>- **并行处理**：支持大规模并发投票</p>
<p>- **缓存优化**：多层缓存策略提升响应速度</p>
<br/>
<h3>🔗 去中心化</h3>
<p>- **区块链存储**：关键数据不可篡改</p>
<p>- **IPFS存储**：去中心化数据存储</p>
<p>- **多节点支持**：避免单点故障</p>
<br/>
<h3>✅ 可验证性</h3>
<p>- **公开验证**：所有决策结果可公开验证</p>
<p>- **透明计算**：偏好汇总计算过程透明可验证</p>
<p>- **Merkle树**：数据完整性证明</p>
<p>- **数字签名**：身份认证和防篡改</p>
<p> - **范围声明**：零知识证明不在本期范围；统一存储边界：链上最小化 + IPFS（CID/版本为单一真实源）。</p>
<br/>
<h3>🪙 代币权限控制</h3>
<p>- **$LUCKEE代币验证**：基于代币持有量的权限管理</p>
<p>- **多级权限系统**：支持基础、创建者、管理员权限</p>
<p>- **动态权限调整**：根据代币持有量自动调整权限</p>
<br/>
<h3>🎨 NFT化投票资格</h3>
<p>- **投票资格NFT**：以账户-`NFT`持有关系确定资格，投票项目作为`NFT`属性接口配置</p>
<p>- **智能合约管理**：基于CW721标准的NFT合约</p>
<p>- **元数据与明细**：IPFS存储NFT元数据与投票明细，链上仅存摘要/结果</p>
<p>- **序号关联**：NFT包含结果相关信息</p>
<br/>
<h3>🎯 多等级选择（多组多目标选择）</h3>
<p>- **等级配置管理**：支持自定义等级与组合</p>
<p>- **智能选择**：基于投票数据的公平选择算法</p>
<p>- **序号分配**：为每个结果分配唯一序号</p>
<p>- **结果验证审计**：完整的结果验证和审计机制</p>
<br/>
<p>> 关系澄清：唯一中奖是多目标选择（n 选 k）的特例（k=1）；多等级选择等价于多个 n 选 k 的组合（各等级各自的 k 与规则），可视为“多组多目标选择”。</p>
<p>> 形式化参考：参见《技术选型/多目标选择技术实现方案.md》3.A（Φ、0→n、nextUnique、S_j/O_j）。</p>
<br/>
<h3>🎲 多目标选择（抽奖/彩票的选择模式）</h3>
<p>- **公平选择机制**：从n个参与者中选出k个不同的序号</p>
<p>- **iAgent自动化**：自动化处理承诺和揭示过程，减少用户操作负担</p>
<p>- **策略性选择**：参与者可根据策略选择偏好值影响结果</p>
<p>- **防冲突算法**：确保所有序号互不相同，支持大规模参与者</p>
<p>- **透明验证**：完整的计算过程证明，支持第三方验证和审计</p>
<br/>
<p>> 偏好值说明：单个多目标选择对应 1 组偏好值；多个多目标选择（如多等级）对应多组偏好值（各选择/等级各一组）。</p>
<br/>
<h2>技术架构</h2>
<br/>
<h3>技术栈选择</h3>
<p>- **核心语言**：Rust + WebAssembly</p>
<p>- **区块链平台**：Injective Protocol</p>
<p>- **智能合约**：Rust (CosmWasm)</p>
<p>- **密码学库**：RustCrypto、sha2、rand</p>
<p>- **存储方案**：IPFS去中心化存储 + 链上哈希验证</p>
<p>- **前端框架**：React + TypeScript</p>
<p>- **代币标准**：CW20 (CosmWasm代币标准)</p>
<p>- **NFT标准**：CW721 (CosmWasm NFT标准)</p>
<br/>
<p>#### 存储边界与单一真实源</p>
<p>- 链上最小化：仅记录账户-`NFT`关联与必要结果摘要/哈希/CID及少量索引，控制Gas与状态膨胀。</p>
<p>- 链下明细（IPFS）：承载承诺/揭示明细、参与者列表、计算过程与证明、会话完整配置与审计日志。</p>
<p>- 单一真实源（Single Source of Truth）：以 IPFS `CID/版本`作为配置与明细的唯一真实源；链上仅做完整性校验与可验证引用。</p>
<br/>
<h3>系统模块</h3>
<p>1. **密码学核心模块** - 比特承诺协议、随机数生成、哈希函数、序号生成</p>
<p>2. **代币验证模块** - 代币持有验证、权限控制、多级权限管理</p>
<p>3. **NFT管理模块** - NFT创建、元数据管理、投票资格验证、序号分配</p>
<p>4. **多等级选择模块** - 等级配置、结果选择、序号分配</p>
<p>5. **多目标选择模块** - 公平选择算法、iAgent自动化、会话管理、结果验证</p>
<p>6. **WebAssembly服务器模块** - 决策投票生命周期管理、区块链接口、存储适配</p>
<p>7. **区块链智能合约** - 偏好投票承诺存储、决策结果验证、状态管理、代币合约、NFT合约</p>
<p>8. **客户端SDK** - 偏好投票操作封装、验证工具、连接管理、NFT管理、代币验证</p>
<p>9. **存储策略模块** - 链上优化、IPFS适配、完整性验证、NFT元数据存储</p>
<br/>
<h2>文档体系</h2>
<br/>
<h3>📋 需求说明书</h3>
<p>- **项目背景与目标**：明确系统建设目的和预期效果</p>
<p>- **功能需求**：详细描述用户管理、投票管理、结果管理等核心功能</p>
<p>- **代币权限需求**：代币持有验证、权限等级管理</p>
<p>- **NFT功能需求**：NFT创建、投票资格管理、中奖序号关联</p>
<p>- **抽奖等级需求**：多等级抽奖、中奖者选择、结果验证</p>
<p>- **多目标选择需求**：公平选择算法、iAgent自动化、会话管理、结果验证</p>
<p>- **非功能需求**：性能、安全、可靠性、兼容性等质量要求</p>
<p>- **系统约束**：技术、法律、业务等约束条件</p>
<p>- **验收标准**：功能、性能、安全等验收指标</p>
<br/>
<p>> 关系说明：唯一中奖=k=1；多等级=多个 n 选 k 组合；偏好组按会话/等级划分；资源分配按竞用性/非竞用性进行需求拆分。</p>
<br/>
<h3>🏗️ 概要设计说明书</h3>
<p>- **系统架构**：整体架构图和分层设计</p>
<p>- **模块设计**：各模块的接口定义和职责划分</p>
<p>- **代币验证设计**：代币持有验证、权限控制架构</p>
<p>- **NFT管理设计**：NFT创建流程、投票资格验证</p>
<p>- **抽奖等级设计**：等级配置、中奖算法、序号分配</p>
<p>- **多目标选择设计**：公平选择算法、iAgent自动化、会话管理</p>
<p>- **数据流设计**：投票提交流程、揭示流程、验证流程</p>
<p>- **接口设计**：RESTful API、WebSocket、区块链事件</p>
<p>- **安全设计**：隐私保护、数据安全、系统安全、代币安全</p>
<p>- **性能优化**：计算优化、存储优化、网络优化</p>
<br/>
<p>> 设计关系：唯一中奖视为 n 选 1；多等级=多个 n 选 k；偏好组按选择维度分组；资源分配按竞用性/非竞用性建模。</p>
<br/>
<h3>🔧 详细设计说明书</h3>
<p>- **密码学实现**：比特承诺协议的具体算法和数据结构、中奖序号生成算法</p>
<p>- **代币验证实现**：代币持有验证、权限控制、多级权限管理</p>
<p>- **NFT管理实现**：NFT创建、元数据管理、投票资格验证、中奖序号分配</p>
<p>- **抽奖等级实现**：等级配置管理、中奖者选择算法、结果验证审计</p>
<p>- **多目标选择实现**：公平选择算法、iAgent自动化、会话管理、结果验证</p>
<p>- **WebAssembly模块**：投票生命周期状态机和区块链交互接口</p>
<p>- **智能合约**：Injective合约的完整代码实现、代币合约、NFT合约</p>
<p>- **客户端SDK**：TypeScript SDK的完整实现、NFT管理接口、代币验证接口</p>
<p>- **存储策略**：分层存储和数据完整性验证机制、NFT元数据存储</p>
<p>- **性能优化**：WebAssembly优化和缓存策略、批量操作优化</p>
<p>- **安全机制**：防重放攻击和输入验证、代币安全、NFT安全</p>
<p>- **测试策略**：单元测试和集成测试、抽奖算法测试</p>
<p>- **部署配置**：Docker配置和环境设置</p>
<br/>
<p>> 实现关系：唯一中奖=n 选 1；多等级=多个 n 选 k 的编排；偏好组映射到选择实例；资源分配实现区分竞用性/非竞用性策略与约束。</p>
<br/>
<h2>📚 文档关系与功能定位</h2>
<br/>
<h3>🔗 文档层次结构</h3>
<pre><code>
项目总览.md (顶层概述)
    │
    ├── README.md (快速入门)
    │   ├── 项目简介
    │   ├── 快速开始
    │   └── 技术栈概览
    │
    ├── 需求说明书.md (需求定义)
    │   ├── 功能需求
    │   ├── 非功能需求
    │   └── 验收标准
    │
    ├── 概要设计说明书.md (架构设计)
    │   ├── 系统架构
    │   ├── 模块设计
    │   └── 接口定义
    │
    ├── 详细设计说明书.md (实现设计)
    │   ├── 算法实现
    │   ├── 代码结构
    │   └── 部署配置
    │
    └── 技术选型/ (技术方案)
        ├── 技术脉络总结.md
        ├── 多目标选择技术实现方案.md
        ├── 多应用场景支持设计说明书.md
        ├── IPFS存储策略设计说明书.md
        ├── iAgent自动化功能设计说明书.md
        └── Rust智能合约开发指南.md
</code></pre>
<br/>
<h3>📋 各文档详细功能定位</h3>
<br/>
<p>#### 1. **README.md - 项目入口和快速导航**</p>
<p>**主要作用**：</p>
<p>- 项目快速入门指南</p>
<p>- 技术栈概览和快速开始</p>
<p>- 文档导航和快速定位</p>
<br/>
<p>**功能定位**：</p>
<p>- **目标用户**：新用户、快速浏览者、开发者入门</p>
<p>- **阅读时间**：5-10分钟</p>
<p>- **内容深度**：概览级别，提供关键信息摘要</p>
<br/>
<p>**核心内容**：</p>
<p>- 项目简介和核心特性</p>
<p>- 技术栈和系统架构概览</p>
<p>- 快速开始指南和开发环境搭建</p>
<p>- 完整的文档导航和快速定位</p>
<br/>
<p>#### 2. **需求说明书.md - 系统需求定义**</p>
<p>**主要作用**：</p>
<p>- 明确系统建设目标和范围</p>
<p>- 定义功能需求和非功能需求</p>
<p>- 制定验收标准和约束条件</p>
<br/>
<p>**功能定位**：</p>
<p>- **目标用户**：产品经理、项目经理、需求分析师</p>
<p>- **阅读时间**：15-30分钟</p>
<p>- **内容深度**：需求级别，明确系统要做什么</p>
<br/>
<p>**核心内容**：</p>
<p>- 项目背景、目标和价值</p>
<p>- 详细的功能需求描述</p>
<p>- 性能、安全、可靠性等非功能需求</p>
<p>- 技术、法律、业务约束条件</p>
<p>- 明确的验收标准和指标</p>
<br/>
<p>#### 3. **概要设计说明书.md - 系统架构设计**</p>
<p>**主要作用**：</p>
<p>- 设计系统整体架构和模块划分</p>
<p>- 定义模块间接口和数据流</p>
<p>- 制定技术方案和设计原则</p>
<br/>
<p>**功能定位**：</p>
<p>- **目标用户**：系统架构师、技术负责人、高级开发者</p>
<p>- **阅读时间**：30-60分钟</p>
<p>- **内容深度**：架构级别，明确系统怎么做</p>
<br/>
<p>**核心内容**：</p>
<p>- 系统整体架构图和分层设计</p>
<p>- 各功能模块的职责划分和接口定义</p>
<p>- 数据流设计和业务流程</p>
<p>- 安全设计和性能优化策略</p>
<p>- 技术选型和实现方案</p>
<br/>
<p>#### 4. **详细设计说明书.md - 具体实现设计**</p>
<p>**主要作用**：</p>
<p>- 提供具体的实现细节和代码结构</p>
<p>- 定义算法实现和数据结构</p>
<p>- 制定测试策略和部署方案</p>
<br/>
<p>**功能定位**：</p>
<p>- **目标用户**：开发工程师、测试工程师、运维工程师</p>
<p>- **阅读时间**：60-120分钟</p>
<p>- **内容深度**：实现级别，明确具体如何实现</p>
<br/>
<p>**核心内容**：</p>
<p>- 密码学算法的具体实现</p>
<p>- 智能合约的完整代码结构</p>
<p>- WebAssembly模块的实现细节</p>
<p>- 客户端SDK的接口定义</p>
<p>- 测试用例和部署配置</p>
<br/>
<p>#### 5. **技术选型目录 - 技术方案集合**</p>
<p>**主要作用**：</p>
<p>- 提供完整的技术选型文档</p>
<p>- 详细的技术实现方案</p>
<p>- 技术架构和设计思路</p>
<br/>
<p>**功能定位**：</p>
<p>- **目标用户**：技术架构师、高级开发者、技术决策者</p>
<p>- **阅读时间**：根据具体文档而定</p>
<p>- **内容深度**：技术级别，提供技术实现指导</p>
<br/>
<p>**核心内容**：</p>
<p>- **技术脉络总结.md**：技术架构和实现方案总览</p>
<p>- **多目标选择技术实现方案.md**：多目标选择系统详细设计</p>
<p>- **多应用场景支持设计说明书.md**：多应用场景技术架构</p>
<p>- **IPFS存储策略设计说明书.md**：去中心化存储方案</p>
<p>- **iAgent自动化功能设计说明书.md**：自动化功能设计</p>
<p>- **Rust智能合约开发指南.md**：智能合约开发指南</p>
<br/>
<h3>🔄 文档间的相互关系</h3>
<br/>
<p>#### 1. **依赖关系**</p>
<pre><code>
需求说明书 → 概要设计说明书 → 详细设计说明书
     ↓              ↓              ↓
技术选型文档 ← 技术脉络总结 ← 具体技术实现
</code></pre>
<br/>
<p>**说明**：</p>
<p>- 需求说明书是设计的基础，概要设计说明书基于需求进行架构设计</p>
<p>- 详细设计说明书基于概要设计进行具体实现设计</p>
<p>- 技术选型文档为各阶段设计提供技术支撑</p>
<br/>
<p>#### 2. **引用关系**</p>
<p>- **项目总览.md**：引用所有其他文档，提供完整项目视图</p>
<p>- **README.md**：引用项目总览获取详细信息，引用技术选型获取技术细节</p>
<p>- **概要设计说明书.md**：引用需求说明书确认需求，引用技术选型确定技术方案</p>
<p>- **详细设计说明书.md**：引用概要设计说明书确认架构，引用技术选型实现具体功能</p>
<br/>
<p>#### 3. **互补关系**</p>
<p>- **README.md** vs **项目总览.md**：快速入门 vs 详细概述</p>
<p>- **需求说明书.md** vs **概要设计说明书.md**：做什么 vs 怎么做</p>
<p>- **概要设计说明书.md** vs **详细设计说明书.md**：架构设计 vs 具体实现</p>
<p>- **技术脉络总结.md** vs **具体技术文档**：技术概览 vs 技术细节</p>
<br/>
<h3>📖 文档使用建议</h3>
<br/>
<p>#### 1. **新用户阅读路径**</p>
<pre><code>
README.md → 项目总览.md → 需求说明书.md → 概要设计说明书.md
</code></pre>
<br/>
<p>**说明**：从快速入门开始，逐步深入了解项目全貌、需求定义和架构设计</p>
<br/>
<p>#### 2. **开发者阅读路径**</p>
<pre><code>
README.md → 技术选型/技术脉络总结.md → 概要设计说明书.md → 详细设计说明书.md
</code></pre>
<br/>
<p>**说明**：从技术概览开始，了解系统架构，深入具体实现细节</p>
<br/>
<p>#### 3. **技术决策者阅读路径**</p>
<pre><code>
项目总览.md → 技术选型/技术脉络总结.md → 概要设计说明书.md
</code></pre>
<br/>
<p>**说明**：从项目整体了解开始，重点关注技术架构和实现方案</p>
<br/>
<p>#### 4. **项目经理阅读路径**</p>
<pre><code>
README.md → 项目总览.md → 需求说明书.md → 开发计划
</code></pre>
<br/>
<p>**说明**：从项目概览开始，重点关注需求定义和开发计划</p>
<br/>
<h3>🔍 文档维护和更新</h3>
<br/>
<p>#### 1. **更新原则**</p>
<p>- 需求变更时，优先更新需求说明书</p>
<p>- 架构调整时，同步更新概要设计说明书</p>
<p>- 技术方案变更时，更新相关技术选型文档</p>
<p>- 实现细节变更时，更新详细设计说明书</p>
<br/>
<p>#### 2. **版本控制**</p>
<p>- 每个文档都有明确的版本标识</p>
<p>- 重大变更需要更新文档版本</p>
<p>- 建立文档变更日志和更新记录</p>
<br/>
<p>#### 3. **一致性检查**</p>
<p>- 定期检查文档间的一致性</p>
<p>- 确保技术方案与架构设计一致</p>
<p>- 验证实现细节与需求定义一致</p>
<br/>
<h2>核心流程</h2>
<br/>
<h3>NFT类型投票配置流程（投票项目属性接口）</h3>
<p>1. 用户验证$LUCKEE代币持有量</p>
<p>2. 创建/更新NFT类型全局参数配置（写入IPFS，返回CID/版本）</p>
<p>3. 设置抽奖等级（如适用，配置写入IPFS，链上仅存CID）</p>
<p>4. 创建/引用对应的NFT合约</p>
<p>5. 在链上记录必要的摘要/索引（账户-NFT关联与结果摘要）</p>
<p>6. 返回配置CID/版本与NFT合约地址</p>
<br/>
<h3>NFT创建和分配流程</h3>
<p>1. 根据NFT类型全局参数配置创建NFT元数据（元数据与配置引用CID）</p>
<p>2. 将元数据存储到IPFS</p>
<p>3. 在NFT合约中铸造NFT</p>
<p>4. 为NFT分配投票资格</p>
<p>5. 记录账户与NFT的关联关系与必要的结果摘要</p>
<br/>
<h3>偏好投票提交流程</h3>
<p>1. 决策人验证NFT所有权</p>
<p>2. 选择偏好值（整数）</p>
<p>3. 客户端生成随机数</p>
<p>4. 使用比特承诺协议生成偏好投票承诺</p>
<p>5. 提交承诺到区块链</p>
<p>6. 存储决策投票详情到IPFS</p>
<p>7. 返回交易哈希</p>
<br/>
<h3>偏好投票揭示流程</h3>
<p>1. 决策投票期结束后</p>
<p>2. 决策人提交原始偏好值和随机数</p>
<p>3. 验证偏好投票承诺的正确性</p>
<p>4. 更新偏好投票统计</p>
<p>5. 计算最终决策结果（偏好值汇总）</p>
<br/>
<h3>抽奖结果计算流程</h3>
<p>1. 收集所有参与者的随机数</p>
<p>2. 根据抽奖等级配置分配中奖者</p>
<p>3. 为每个中奖者分配中奖序号</p>
<p>4. 更新NFT元数据中的中奖信息</p>
<p>5. 生成抽奖结果证明</p>
<br/>
<h3>决策结果验证流程</h3>
<p>1. 获取所有偏好投票承诺</p>
<p>2. 验证每个偏好投票的有效性</p>
<p>3. 计算Merkle根</p>
<p>4. 与链上记录的结果摘要/CID比对</p>
<p>5. 生成决策结果验证报告</p>
<br/>
<p>#### 抽奖场景具体流程</p>
<p>**抽奖提交流程**：</p>
<p>1. 抽奖参与者验证NFT所有权</p>
<p>2. 选择随机数（整数）</p>
<p>3. 客户端生成随机种子</p>
<p>4. 使用比特承诺协议生成随机数承诺</p>
<p>5. 提交承诺到区块链</p>
<p>6. 存储抽奖活动详情到IPFS</p>
<p>7. 返回交易哈希</p>
<br/>
<p>**抽奖揭示流程**：</p>
<p>1. 抽奖期结束后</p>
<p>2. 参与者提交原始随机数和随机种子</p>
<p>3. 验证随机数承诺的正确性</p>
<p>4. 更新随机数统计</p>
<p>5. 计算最终抽奖结果（随机数总和对参与者数量取余）</p>
<br/>
<p>**抽奖结果验证流程**：</p>
<p>1. 获取所有随机数承诺</p>
<p>2. 验证每个随机数的有效性</p>
<p>3. 计算随机数总和</p>
<p>4. 验证取余计算过程</p>
<p>5. 生成抽奖结果验证报告</p>
<p>6. 验证中奖序号分配的正确性</p>
<br/>
<h3>统一NFT决策状态机</h3>
<br/>
<p>状态：Draft → CommitOpen → CommitClosed → RevealOpen → Revealed → Tallied → Executed → Archived</p>
<br/>
<p>- 时间参数控制从提交到揭示与执行的开窗；</p>
<p>- 状态迁移与审计事件绑定；</p>
<p>- 抽奖/彩票/分配/治理等通过NFT类型规则映射到统一状态机。</p>
<br/>
<h3>NFT 决策接口（抽象）</h3>
<br/>
<p>1. 提案/会话创建（含NFT类型与时间参数）</p>
<p>2. 偏好投票提交（承诺）</p>
<p>3. 隐私保护（比特承诺）</p>
<p>4. 揭示与计票（单/多目标、竞/非竞）</p>
<p>5. 决策执行（按NFT类型落地执行）</p>
<br/>
<h3>多目标选择场景具体流程</h3>
<p>**会话创建流程**：</p>
<p>1. 系统管理员创建多目标选择会话</p>
<p>2. 设置参与者数量n和目标数量k</p>
<p>3. 配置承诺和揭示时间窗口</p>
<p>4. 创建会话配置并存储到区块链</p>
<p>5. 返回会话ID和配置信息</p>
<br/>
<p>**参与者注册流程**：</p>
<p>1. 参与者验证NFT所有权</p>
<p>2. 选择k个偏好值（整数）</p>
<p>3. 配置iAgent自动化参数</p>
<p>4. 注册到会话中</p>
<p>5. 等待承诺阶段开始</p>
<br/>
<p>**自动化承诺流程**：</p>
<p>1. iAgent自动生成比特承诺</p>
<p>2. 将承诺存储到IPFS</p>
<p>3. 提交承诺哈希到区块链</p>
<p>4. 记录操作日志和状态</p>
<p>5. 等待揭示阶段触发</p>
<br/>
<p>**自动化揭示流程**：</p>
<p>1. 满足揭示条件时自动触发</p>
<p>2. iAgent揭示所有参与者的真实值</p>
<p>3. 验证承诺的正确性</p>
<p>4. 更新会话状态</p>
<p>5. 进入中奖计算阶段</p>
<br/>
<p>**中奖计算流程**：</p>
<p>1. 收集所有参与者的k个值</p>
<p>2. 计算基准中奖序号A1</p>
<p>3. 计算偏移中奖序号A2到Ak</p>
<p>4. 确保所有中奖序号互不相同</p>
<p>5. 生成计算证明和结果</p>
<br/>
<p>**结果验证流程**：</p>
<p>1. 验证所有承诺的正确性</p>
<p>2. 验证中奖计算过程的正确性</p>
<p>3. 验证中奖序号的唯一性</p>
<p>4. 生成完整性验证报告</p>
<p>5. 支持第三方审计验证</p>
<br/>
<h2>性能指标</h2>
<br/>
<h3>系统性能</h3>
<p>- **响应时间**：偏好投票操作响应时间 ≤ 3秒</p>
<p>- **吞吐量**：支持每秒1000+并发偏好投票操作</p>
<p>- **扩展性**：支持百万级决策人规模</p>
<p>- **可用性**：系统可用性达到99.9%</p>
<br/>
<h3>代币验证性能</h3>
<p>- **代币查询响应时间**：≤ 1秒</p>
<p>- **批量验证支持**：支持1000+用户并发验证</p>
<p>- **权限检查延迟**：≤ 500毫秒</p>
<br/>
<h3>NFT操作性能</h3>
<p>- **NFT创建时间**：≤ 5秒</p>
<p>- **元数据存储时间**：≤ 3秒</p>
<p>- **批量操作支持**：支持100+ NFT并发创建</p>
<br/>
<h3>抽奖系统性能</h3>
<p>- **中奖者选择时间**：≤ 10秒（1000参与者）</p>
<p>- **中奖序号分配时间**：≤ 5秒</p>
<p>- **结果验证时间**：≤ 3秒</p>
<br/>
<h3>多目标选择系统性能</h3>
<p>- **会话创建时间**：≤ 3秒</p>
<p>- **参与者注册时间**：≤ 2秒</p>
<p>- **承诺处理时间**：≤ 5秒（1000参与者）</p>
<p>- **揭示处理时间**：≤ 8秒（1000参与者）</p>
<p>- **中奖计算时间**：≤ 10秒（1000参与者，10个目标）</p>
<p>- **结果验证时间**：≤ 5秒</p>
<p>- **并发支持**：支持10000+参与者同时参与</p>
<br/>
<h3>安全指标</h3>
<p>- **隐私保护**：偏好投票内容对第三方不可见</p>
<p>- **数据完整性**：确保偏好投票数据不被篡改</p>
<p>- **身份验证**：防止身份伪造和重复投票</p>
<p>- **抗攻击性**：抵御常见的网络攻击</p>
<p>- **偏好保护**：确保决策人的偏好值在揭示前不被泄露</p>
<p>- **防重放攻击**：防止投票被重复提交</p>
<p>- **代币安全**：防止代币余额操纵和权限提升</p>
<p>- **NFT安全**：防止NFT重复使用和所有权伪造</p>
<p>- **多目标选择安全**：防止参与者操纵选择值，确保iAgent操作安全</p>
<br/>
<h2>开发计划</h2>
<br/>
<h3>第一阶段：基础架构（4周）</h3>
<p>- 密码学核心模块开发</p>
<p>- WebAssembly服务器基础框架</p>
<p>- 区块链智能合约开发</p>
<p>- 基础测试框架搭建</p>
<br/>
<h3>第二阶段：代币和NFT系统（6周）</h3>
<p>- 代币验证模块开发</p>
<p>- NFT管理模块开发</p>
<p>- 权限控制系统实现</p>
<p>- 智能合约集成测试</p>
<br/>
<h3>第三阶段：抽奖等级系统（4周）</h3>
<p>- 抽奖等级配置管理</p>
<p>- 中奖者选择算法实现</p>
<p>- 中奖序号分配系统</p>
<p>- 结果验证和审计机制</p>
<br/>
<h3>第四阶段：多目标选择系统（6周）</h3>
<p>- 多目标选择算法实现</p>
<p>- iAgent自动化框架</p>
<p>- 会话管理和状态机</p>
<p>- 结果验证和审计机制</p>
<br/>
<h3>第五阶段：核心功能（6周）</h3>
<p>- 决策投票生命周期管理</p>
<p>- 偏好投票客户端SDK开发</p>
<p>- 存储策略实现</p>
<p>- 基础安全机制</p>
<br/>
<h3>第六阶段：性能优化（4周）</h3>
<p>- WebAssembly性能优化</p>
<p>- 缓存策略实现</p>
<p>- 并发处理优化</p>
<p>- 压力测试和调优</p>
<br/>
<h3>第七阶段：集成测试（2周）</h3>
<p>- 端到端集成测试</p>
<p>- 安全审计</p>
<p>- 性能测试</p>
<p>- 文档完善</p>
<br/>
<h2>风险评估</h2>
<br/>
<h3>技术风险</h3>
<p>- **区块链性能瓶颈**：通过优化和分层存储缓解</p>
<p>- **密码学算法安全性**：使用成熟的标准算法</p>
<p>- **WebAssembly兼容性问题**：充分测试和降级方案</p>
<p>- **代币合约安全性**：专业安全审计和测试</p>
<p>- **NFT标准兼容性**：遵循CW721标准规范</p>
<br/>
<h3>业务风险</h3>
<p>- **用户接受度**：提供友好的用户界面和详细文档</p>
<p>- **监管政策变化**：持续关注合规要求</p>
<p>- **竞争环境变化**：保持技术领先优势</p>
<p>- **市场推广**：制定有效的市场推广策略</p>
<p>- **代币经济模型**：设计合理的代币激励机制</p>
<br/>
<h2>项目价值</h2>
<br/>
<h3>技术创新</h3>
<p>- 首次将比特承诺协议应用于大规模决策投票系统</p>
<p>- 偏好值汇总算法的创新实现</p>
<p>- Rust WebAssembly在区块链应用中的创新应用</p>
<p>- 去中心化存储与区块链的深度集成</p>
<p>- 代币权限控制与NFT化投票资格的创新结合</p>
<p>- 多等级抽奖系统的智能算法设计</p>
<p>- 多目标选择系统的公平算法和iAgent自动化</p>
<br/>
<h3>社会价值</h3>
<p>- 为集体决策提供安全、透明、可验证的技术方案</p>
<p>- 推动区块链技术在政务和企业决策领域的应用</p>
<p>- 提升决策系统的可信度和参与度</p>
<p>- 建立公平、透明的抽奖和奖励机制</p>
<p>- 促进代币经济的发展和应用</p>
<br/>
<h3>商业价值</h3>
<p>- 为政府和企业提供专业的决策投票解决方案</p>
<p>- 建立可扩展的决策投票平台生态</p>
<p>- 推动相关技术标准的制定</p>
<p>- 创造新的商业模式和收入来源</p>
<p>- 建立代币经济生态系统</p>
<br/>
<h2>总结</h2>
<br/>
<p>本项目通过创新的技术架构和严谨的设计文档，构建了一个完整的去中心化决策投票系统解决方案。系统在保证隐私性和安全性的同时，实现了高性能和可扩展性，为大规模决策场景提供了可靠的技术支撑。</p>
<br/>
<p>系统集成的代币权限控制、NFT化投票资格管理、多等级选择（多组多目标选择）系统和多目标选择系统，为用户提供了完整、丰富和灵活的投票体验。</p>
<br/>
<p>多目标选择系统通过创新的公平选择算法和iAgent自动化，为大规模参与者选择提供了高效、透明、可验证的解决方案。第一期仅用于去中心化抽奖（n选1、n选k），分配、治理等应用场景在后续迭代支持。</p>
<br/>
<p>通过需求说明书、概要设计说明书和详细设计说明书的完整文档体系，项目具备了清晰的开发指导和验收标准，为后续的开发实施奠定了坚实的基础。</p>
<br/>
<p>---</p>
<br/>
<p>**文档编制日期**：2025年8月</p>
<p>**文档编制人**：luckeeDAO技术评估团队</p>
<p>**文档审核人**：luckeeDAO管理委员会</p>
<br/>
<p>> 🔗 **相关文档**：</p>
<p>> - [README.md](../README.md) - 项目快速入门和导航指南</p>
<p>> - [技术选型目录](技术选型/) - 完整的技术选型文档集合</p>
<p>> - [需求说明书](需求说明书.md) - 系统功能需求和非功能需求</p>
<p>> - [概要设计说明书](概要设计说明书.md) - 系统架构和模块设计</p>
</body>
</html>
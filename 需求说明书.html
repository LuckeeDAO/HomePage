<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>需求说明书</title>
    <style>
        body {
            max-width: 860px;
            margin: 32px auto;
            padding: 0 16px;
            font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            line-height: 1.6;
            color: #1f2937;
        }
        pre { background:#f8fafc; padding:12px; overflow:auto; border-radius:6px; }
        code { background:#f1f5f9; padding:2px 4px; border-radius:4px; }
        h1,h2,h3,h4,h5,h6 { line-height:1.25; }
        a { color:#2563eb; text-decoration:none; }
        a:hover { text-decoration:underline; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #e5e7eb; padding: 8px; }
        blockquote { margin: 0; padding-left: 1em; border-left: 4px solid #e5e7eb; color:#6b7280; }
    </style>
</head>
<body>
<p>﻿# 基于比特承诺模型的去中心化投票系统需求说明书</p>
<blockquote>
<p>用词规范：请参阅《<a href="项目术语表.html">项目术语表</a>》以确保术语统一。</p>
</blockquote>
<h2 id="1">1. 项目概述</h2>
<h3 id="11">1.1 项目背景</h3>
<p>随着区块链技术的发展，去中心化应用在各个领域得到广泛应用。去中心化决策投票系统作为集体决策的重要工具，需要确保决策结果的公平性、透明性和可验证性。本项目旨在构建一个基于比特承诺模型的去中心化决策投票系统，结合Rust WebAssembly高性能计算与区块链技术的不可篡改特性，支持大规模决策场景。</p>
<p>去中心化决策投票的核心特征是：决策结果不依赖任何一个人或者一部分人，其结果包含了全体决策人的偏好汇总，任何一个人的投票结果都会影响最后的结果。每个决策人的偏好用整数表示，系统通过透明且可验证的计算过程，汇总所有人的偏好，得出最终的决策结果。</p>
<h4 id="112">1.1.2 决策类型统一术语与分类</h4>
<ul>
<li>按结果基数：</li>
<li>单目标决策：每次仅产生一个获胜结果（例：单一中奖、单提案通过）。</li>
<li>多目标决策：一次产生多个互不冲突的获胜结果（例：从n选k）。</li>
<li>按资源属性（分配/治理）：</li>
<li>竞用性资源决策：有限且排他（名额/额度等）。</li>
<li>非竞用性资源决策：非排他，可并行满足（公共品偏好）。</li>
<li>扩展性：通过NFT类型抽象承载，未来可新增更多决策类型。</li>
</ul>
<h4 id="111">1.1.1 具体应用场景</h4>
<p>系统支持多种去中心化决策投票应用场景，这些应用场景通过使用者创建不同的NFT类型来进行控制。以下是几个典型示例：</p>
<p><strong>应用场景1：去中心化抽奖</strong>
以去中心化抽奖为例，系统的工作流程如下：
1. <strong>NFT分发</strong>：系统通过分发抽奖NFT来管理参与者，替代传统的用户注册功能
2. <strong>提交随机数</strong>：每个NFT持有者提交一个整数作为自己的随机数
3. <strong>隐私保护</strong>：使用比特承诺协议保护每个参与者的随机数不被泄露
4. <strong>结果计算</strong>：系统累加所有参与者的整数之和，并对投票总人数进行取余
5. <strong>结果验证</strong>：最终得到的余数作为抽奖结果，整个过程透明可验证</p>
<p>例如：有5个参与者，分别提交整数[3, 7, 2, 9, 1]，总和为22，对5取余得到2，则抽奖结果为2号参与者。</p>
<p><strong>应用场景2：去中心化彩票</strong>
去中心化彩票系统的工作流程：
1. <strong>彩票NFT分发</strong>：用户获得彩票NFT，替代传统注册流程
2. <strong>偏好提交</strong>：每个彩票NFT持有者提交偏好值（如幸运数字）
3. <strong>隐私保护</strong>：使用比特承诺协议保护偏好值不被泄露
4. <strong>开奖计算</strong>：系统汇总所有偏好值，通过算法生成开奖号码
5. <strong>中奖验证</strong>：验证中奖彩票，自动分配奖金</p>
<p><strong>应用场景3：去中心化分配</strong>
去中心化分配系统的工作流程：
1. <strong>资源分配NFT分发</strong>：参与者获得资源分配NFT
2. <strong>偏好表达</strong>：参与者提交对资源的偏好值
3. <strong>隐私保护</strong>：使用比特承诺协议保护偏好信息
4. <strong>分配计算</strong>：基于偏好值计算最优分配方案
5. <strong>结果执行</strong>：自动执行分配结果，更新资源状态</p>
<p><strong>应用场景4：去中心化治理投票</strong>
治理投票系统的工作流程：
1. <strong>治理NFT分发</strong>：参与者获得治理投票NFT
2. <strong>偏好投票</strong>：参与者提交对提案的偏好值
3. <strong>隐私保护</strong>：使用比特承诺协议保护投票偏好
4. <strong>结果统计</strong>：汇总所有偏好值，计算最终决策
5. <strong>决策执行</strong>：根据投票结果自动执行相应决策</p>
<h3 id="12">1.2 项目目标</h3>
<ul>
<li>实现隐私保护的投票机制</li>
<li>确保投票数据的完整性与可验证性</li>
<li>支持百万级用户规模</li>
<li>平衡性能与去中心化程度</li>
<li>实现基于代币持有量的权限控制</li>
<li><strong>支持通过NFT类型控制不同应用场景</strong></li>
<li><strong>实现NFT分发替代用户注册功能</strong></li>
<li><strong>实现NFT全局状态变量控制比特承诺功能</strong></li>
<li>实现多等级选择（多组多目标选择）系统</li>
<li>第一阶段仅支持去中心化抽奖（n选1、n选k），其他场景（彩票、分配、治理）后续迭代</li>
<li>提供可扩展的应用场景框架</li>
</ul>
<h3 id="13">1.3 技术约束</h3>
<ul>
<li>必须使用Rust + WebAssembly作为服务器端核心逻辑</li>
<li>必须使用区块链平台 Injective（CosmWasm 生态）</li>
<li>必须实现比特承诺协议</li>
<li>保护用户隐私，私钥等信息不提交到后台</li>
<li>必须支持$LUCKEE代币持有验证</li>
<li>必须实现NFT创建和管理功能</li>
<li><strong>必须实现NFT类型控制应用场景的机制</strong></li>
<li><strong>必须实现NFT全局状态变量管理</strong></li>
</ul>
<h3 id="14-in-scope">1.4 项目范围（In Scope）</h3>
<ul>
<li>基于比特承诺的偏好/随机数承诺与揭示流程</li>
<li>基于NFT类型的多应用场景（抽奖、彩票、分配、治理）配置与流转</li>
<li>$LUCKEE 代币持有验证与权限控制（含质押/锁定扩展预留）</li>
<li>统一NFT决策状态机及状态审计事件</li>
<li>链上最小化存储与IPFS明细存储、可验证完整性链路</li>
<li>多目标选择（n选k）与多等级（多组多目标选择）算法与验证</li>
<li>iAgent 自动化（承诺/揭示）的策略、触发与审计</li>
</ul>
<h3 id="15-out-of-scope">1.5 非范围（Out of Scope）</h3>
<ul>
<li>法币出入金与中心化托管功能</li>
<li>非本项目发行的证券型代币设计与募资安排</li>
<li>跨链资产桥接与多链治理（仅预留接口，不纳入首期实现）</li>
<li>零知识证明电路实现细节（不在本期范围）</li>
<li>去中心化彩票、去中心化分配、去中心化治理（纳入后续迭代）</li>
</ul>
<h2 id="2">2. 功能需求</h2>
<h3 id="21-nft">2.1 NFT类型管理模块</h3>
<h4 id="211-nft">2.1.1 NFT类型创建</h4>
<ul>
<li><strong>功能描述</strong>：使用者通过创建不同的NFT类型来控制不同的应用场景</li>
<li><strong>输入</strong>：NFT类型定义、应用场景配置、元数据模式</li>
<li><strong>输出</strong>：NFT类型ID、创建确认、应用场景配置</li>
<li><strong>约束</strong>：只有持有足够$LUCKEE代币的账户才能创建NFT类型</li>
</ul>
<h4 id="212">2.1.2 应用场景配置</h4>
<ul>
<li><strong>功能描述</strong>：根据NFT类型配置相应的应用场景参数和规则</li>
<li><strong>输入</strong>：NFT类型、应用场景配置、规则设置</li>
<li><strong>输出</strong>：配置确认、配置ID列表</li>
<li><strong>约束</strong>：只有NFT类型创建者可以设置应用场景配置</li>
</ul>
<p><strong>具体配置类型：</strong>
- <strong>抽奖NFT类型配置</strong>：设置不同等级与每个等级的数量（即多个 n 选 k 组合）
- <strong>彩票NFT类型配置</strong>：设置彩票类型、开奖规则、奖金分配
- <strong>分配NFT类型配置</strong>：设置资源分配算法、权重参数、约束条件
- <strong>治理NFT类型配置</strong>：设置投票规则、提案流程、决策阈值</p>
<h3 id="22-nft">2.2 NFT决策接口（抽象需求）</h3>
<ul>
<li>提案/会话创建：设置NFT类型与时间参数</li>
<li>偏好投票提交：提交偏好值</li>
<li>隐私保护：使用比特承诺提交承诺与盐</li>
<li>揭示与计票：验证承诺并计算最终结果</li>
<li>决策执行：根据结果自动执行相应决策</li>
</ul>
<h3 id="23-nft">2.3 NFT分发管理模块</h3>
<h4 id="221-nft">2.2.1 NFT分发替代用户注册</h4>
<ul>
<li><strong>功能描述</strong>：使用NFT的分发代替传统的用户注册功能</li>
<li><strong>输入</strong>：用户地址、NFT类型、分发策略</li>
<li><strong>输出</strong>：NFT ID、分发确认、用户资格确认</li>
<li><strong>约束</strong>：NFT分发必须验证用户资格，支持批量分发</li>
</ul>
<h4 id="222-nft">2.2.2 NFT资格验证</h4>
<ul>
<li><strong>功能描述</strong>：验证用户是否拥有参与特定应用场景的NFT</li>
<li><strong>输入</strong>：用户地址、NFT类型、应用场景ID</li>
</ul>
<h3 id="24">2.4 多目标选择模块（抽奖/彩票的选择模式）</h3>
<h4 id="231">2.3.1 多目标选择会话管理</h4>
<ul>
<li><strong>功能描述</strong>：创建和管理多目标选择会话，支持从n个参与者中选出k个不同目标</li>
<li><strong>输入</strong>：参与者数量n、目标数量k、会话配置、时间窗口设置</li>
<li><strong>输出</strong>：会话ID、会话状态、配置确认</li>
<li><strong>约束</strong>：只有系统管理员可以创建多目标选择会话</li>
</ul>
<h4 id="232-ai">2.3.2 AI代理自动化</h4>
<ul>
<li><strong>功能描述</strong>：通过AI代理自动化处理承诺和揭示过程，减少用户操作负担</li>
<li><strong>输入</strong>：自动化配置、触发条件、执行策略</li>
<li><strong>输出</strong>：自动化状态、执行日志、操作确认</li>
<li><strong>约束</strong>：AI代理必须经过身份验证，操作权限受NFT状态控制</li>
</ul>
<h4 id="233">2.3.3 公平选择算法</h4>
<ul>
<li><strong>功能描述</strong>：实现公平的多目标选择算法，确保每个参与者的选择都影响最终结果</li>
<li><strong>输入</strong>：参与者选择值、算法参数、验证规则</li>
<li><strong>输出</strong>：中奖序号列表、计算证明、验证报告</li>
<li><strong>约束</strong>：算法必须确保所有中奖序号互不相同，支持大规模参与者</li>
</ul>
<h4 id="234">2.3.4 关系与偏好组说明</h4>
<ul>
<li>唯一中奖：n 选 1（k=1），为多目标选择特例。</li>
<li>多等级选择：等价于多个 n 选 k 的组合，各等级独立配置 k 与规则；定义为“多组多目标选择”。</li>
<li>偏好映射：单个 n 选 k 使用 1 组偏好值；多个 n 选 k（如多等级）使用多组偏好值（各会话/等级各一组）。</li>
</ul>
<h4 id="235">2.3.5 会话状态管理</h4>
<ul>
<li><strong>功能描述</strong>：管理多目标选择会话的完整生命周期，包括创建、注册、承诺、揭示、计算、验证等阶段</li>
<li><strong>输入</strong>：状态变更请求、验证数据、状态参数</li>
<li><strong>输出</strong>：状态确认、状态历史、状态报告</li>
<li><strong>约束</strong>：状态转换必须遵循预定义的状态机规则，支持状态回滚</li>
</ul>
<h3 id="25-nft">2.5 统一NFT决策状态机（需求）</h3>
<p>状态：Draft → CommitOpen → CommitClosed → RevealOpen → Revealed → Tallied → Executed → Archived</p>
<ul>
<li>提供时间参数控制提交/揭示窗口；</li>
<li>承诺/揭示与状态联动；</li>
<li>结果聚合与执行受NFT类型规则约束；</li>
<li>全流程事件审计与可验证性支持。</li>
<li><strong>输出</strong>：资格验证结果、NFT信息</li>
<li><strong>约束</strong>：只有拥有对应NFT类型的用户才能参与相应应用场景</li>
</ul>
<h3 id="26-nft">2.6 NFT全局状态管理模块</h3>
<h4 id="231_1">2.3.1 全局状态变量管理</h4>
<ul>
<li><strong>功能描述</strong>：NFT存在一个全局的状态变量，用于比特承诺功能的状态控制</li>
<li><strong>输入</strong>：NFT状态更新、状态变更请求</li>
<li><strong>输出</strong>：状态更新确认、新状态值</li>
<li><strong>约束</strong>：状态变更必须通过智能合约验证，支持状态回滚</li>
</ul>
<h4 id="232">2.3.2 比特承诺状态控制</h4>
<ul>
<li><strong>功能描述</strong>：比特承诺合约通过NFT的接口来判断自身的状态，并执行对应的操作</li>
<li><strong>输入</strong>：NFT状态查询、状态变更通知</li>
<li><strong>输出</strong>：状态信息、操作执行结果</li>
<li><strong>约束</strong>：状态控制必须确保原子性，防止状态不一致</li>
</ul>
<h3 id="27-nft">2.7 投票项目管理（作为NFT管理的属性接口）</h3>
<h4 id="241">2.4.1 概念修正与边界</h4>
<ul>
<li><strong>定位修正</strong>：投票项目管理不是独立模块，而是<strong>NFT管理</strong>的一个属性接口；其配置项均为对应NFT类型的<strong>全局参数</strong>（如时间窗口、偏好范围、阈值、是否抽奖/多目标等）。</li>
<li><strong>数据位置</strong>：</li>
<li><strong>IPFS（主要存储）</strong>：投票决策的详细数据（承诺/揭示明细、参与者列表、计算过程与证明、会话完整配置）全部存储在IPFS；链上保存其CID/哈希用于完整性校验。</li>
<li><strong>链上（最小记录集）</strong>：仅记录账户与NFT的关联信息（持有/转移）以及投票结果信息（结果哈希/CID、必要的摘要字段）。</li>
</ul>
<h4 id="242-nft">2.4.2 基于NFT类型的参数配置</h4>
<ul>
<li><strong>功能描述</strong>：为特定<code>NFT类型</code>设置/更新投票相关的全局参数（如提交/揭示时间、偏好范围、是否启用多目标/抽奖等）。</li>
<li><strong>输入</strong>：NFT类型、参数键值对（全局参数集合）、版本号/生效时间（可选）</li>
<li><strong>输出</strong>：参数更新确认、版本号、链上结果摘要或CID</li>
<li><strong>约束</strong>：参数变更遵循权限与状态机约束；变更详情写入IPFS，链上仅存摘要/哈希。</li>
</ul>
<h4 id="243-nft">2.4.3 NFT类型化投票行为控制</h4>
<ul>
<li><strong>功能描述</strong>：根据NFT类型全局参数控制投票行为（资格、阶段、计票策略选择等）。</li>
<li><strong>输入</strong>：NFT类型、投票配置引用（CID/版本号）</li>
<li><strong>输出</strong>：行为控制确认、事件审计</li>
<li><strong>约束</strong>：不同NFT类型可有不同规则；规则详情在IPFS，链上只保留必要的结果摘要。</li>
</ul>
<h3 id="28">2.8 决策投票管理模块</h3>
<h4 id="251-nft">2.5.1 基于NFT的投票资格验证</h4>
<ul>
<li><strong>功能描述</strong>：验证用户是否拥有参与投票的NFT</li>
<li><strong>输入</strong>：用户地址、NFT类型</li>
<li><strong>输出</strong>：投票资格验证结果</li>
<li><strong>约束</strong>：只有拥有对应NFT类型的账户才具有投票资格</li>
</ul>
<h4 id="252">2.5.2 偏好投票参与</h4>
<ul>
<li><strong>功能描述</strong>：决策人参与决策投票活动，提交偏好值</li>
<li><strong>输入</strong>：决策投票ID、偏好值（整数）、NFT证明、NFT类型</li>
<li><strong>输出</strong>：偏好投票承诺、参与确认</li>
<li><strong>约束</strong>：使用比特承诺保护隐私，偏好值必须在有效范围内，必须拥有对应NFT类型</li>
</ul>
<p><strong>不同NFT类型的偏好值含义：</strong>
- <strong>抽奖NFT类型</strong>：偏好值作为随机数，用于抽奖结果计算
- <strong>彩票NFT类型</strong>：偏好值作为幸运数字，影响开奖概率
- <strong>资源分配NFT类型</strong>：偏好值表示对资源的偏好程度，用于分配算法
- <strong>治理投票NFT类型</strong>：偏好值表示对提案的支持程度，用于决策计算</p>
<h3 id="29">2.9 资源分配型投票（决策方式划分）</h3>
<ul>
<li><strong>竞用性决策</strong>：资源有限且排他（名额/额度等），需避免冲突与重叠；支持约束与最优匹配。</li>
<li><strong>非竞用性决策</strong>：资源非排他，可并行满足（公共品偏好表达），侧重偏好强度与阈值满足。</li>
</ul>
<h4 id="283">2.8.3 偏好投票验证</h4>
<ul>
<li><strong>功能描述</strong>：验证偏好投票的有效性</li>
<li><strong>输入</strong>：偏好投票承诺、验证参数、NFT所有权证明、NFT类型</li>
<li><strong>输出</strong>：验证结果</li>
<li><strong>约束</strong>：确保偏好投票不可篡改，验证偏好值格式，验证NFT类型和所有权</li>
</ul>
<h4 id="284-iagent">2.8.4 iAgent自动化投票管理</h4>
<ul>
<li><strong>功能描述</strong>：通过iAgent实现承诺与揭示流程的自动化管理</li>
<li><strong>输入</strong>：自动化配置、承诺策略、揭示条件、NFT类型状态</li>
<li><strong>输出</strong>：自动化投票ID、执行状态、自动化结果</li>
<li><strong>约束</strong>：支持多种自动化策略，确保自动化流程的安全性和可验证性，基于NFT状态执行</li>
</ul>
<p><strong>具体自动化功能：</strong>
- <strong>自动承诺策略</strong>：
  - 立即承诺：用户设置后立即执行承诺操作
  - 定时承诺：在指定时间自动执行承诺操作
  - 条件触发承诺：满足特定条件时自动执行承诺操作
  - 批量承诺：收集多个承诺后批量执行</p>
<ul>
<li><strong>自动揭示策略</strong>：</li>
<li>基于时间：在指定时间自动执行揭示操作</li>
<li>基于参与者数量：达到指定参与者数量时自动揭示</li>
<li>基于投票完成度：投票完成度达到阈值时自动揭示</li>
<li>
<p>智能触发：基于NFT状态智能判断揭示时机</p>
</li>
<li>
<p><strong>自动化监控</strong>：</p>
</li>
<li>实时监控投票状态和自动化执行情况</li>
<li>提供自动化执行日志和状态查询</li>
<li>支持自动化配置的动态更新和调整</li>
<li>基于NFT状态进行自动化决策</li>
</ul>
<h3 id="210">2.10 决策结果管理模块</h3>
<h4 id="2101">2.10.1 偏好汇总计算</h4>
<ul>
<li><strong>功能描述</strong>：汇总所有决策人的偏好值，计算最终决策结果（如抽奖结果）</li>
<li><strong>输入</strong>：所有有效偏好投票承诺、NFT类型信息</li>
<li><strong>输出</strong>：决策结果、偏好汇总统计信息</li>
<li><strong>约束</strong>：确保计算过程透明，结果准确反映全体决策人偏好</li>
</ul>
<h4 id="2102">2.10.2 决策结果验证</h4>
<ul>
<li><strong>功能描述</strong>：验证决策结果的正确性和计算过程的透明度</li>
<li><strong>输入</strong>：决策结果、验证参数、NFT类型状态</li>
<li><strong>输出</strong>：验证结果</li>
<li><strong>约束</strong>：支持公开验证，任何人都可验证计算过程</li>
</ul>
<h4 id="2103">2.10.3 应用场景结果计算</h4>
<ul>
<li><strong>功能描述</strong>：根据不同NFT类型计算相应的最终结果</li>
<li><strong>输入</strong>：所有参与者的偏好值、NFT类型配置</li>
<li><strong>输出</strong>：应用场景特定的结果数据</li>
<li><strong>计算规则</strong>：基于所有参与者的偏好值，根据NFT类型配置计算最终结果</li>
</ul>
<p><strong>不同NFT类型的结果类型：</strong>
- <strong>抽奖NFT类型结果计算</strong>：
  - 输入：所有参与者的随机数、等级配置（多等级选择时为多组多目标选择）
  - 输出：结果（各等级的选择/中奖者列表）
  - 计算规则：累加所有随机数之和，对参与者总数取余，根据等级配置分配结果
- <strong>彩票NFT类型开奖计算</strong>：计算彩票开奖号码和中奖者
  - 输入：所有彩票持有者的幸运数字、彩票规则配置
  - 输出：开奖号码、中奖彩票列表、奖金分配
  - 计算规则：基于幸运数字的哈希值生成开奖号码，根据规则匹配中奖彩票
- <strong>资源分配NFT类型计算</strong>：计算最优的资源分配方案
  - 输入：所有参与者的资源偏好、分配算法配置
  - 输出：资源分配结果、分配证明
  - 计算规则：使用优化算法（如匈牙利算法）计算最优分配方案
- <strong>治理投票NFT类型计算</strong>：计算治理提案的最终决策
  - 输入：所有参与者的投票偏好、治理规则配置
  - 输出：决策结果、执行建议
  - 计算规则：根据投票偏好和权重计算决策得分，应用决策阈值
- <strong>约束</strong>：确保计算过程透明，结果不可篡改，支持多等级中奖</p>
<h4 id="2104">2.10.4 序号/结果分配</h4>
<ul>
<li><strong>功能描述</strong>：为每个NFT分配与投票相关的中奖序号</li>
<li><strong>输入</strong>：NFT信息、投票数据、NFT类型配置</li>
<li><strong>输出</strong>：中奖序号分配结果</li>
<li><strong>约束</strong>：序号/结果必须与投票数据关联，支持多等级（多组）分配</li>
</ul>
<h3 id="211">2.11 存储管理模块</h3>
<h4 id="2111">2.11.1 链上存储（最小化）</h4>
<ul>
<li><strong>功能描述</strong>：仅将最小必要数据存储到区块链</li>
<li><strong>输入</strong>：</li>
<li>账户与NFT的关联信息（持有、转移的事件与当前所有权）</li>
<li>决策结果摘要（结果哈希/CID、必要的统计摘要）</li>
<li>少量索引/指针（指向IPFS详细数据的CID）</li>
<li><strong>输出</strong>：交易哈希、最小化存储确认</li>
<li><strong>约束</strong>：严格最小化链上数据量，优化Gas成本；完整明细不入链。</li>
</ul>
<h4 id="2112-ipfs">2.11.2 IPFS去中心化存储（主要存储）</h4>
<ul>
<li><strong>功能描述</strong>：存储完整的投票与配置明细</li>
<li><strong>输入</strong>：</li>
<li>决策投票全量详情（承诺/揭示明细、参与者、计算过程与证明、事件日志）</li>
<li>NFT信息与元数据、NFT类型的完整配置版本</li>
<li>审计与验证材料</li>
<li><strong>输出</strong>：IPFS CID、访问链接</li>
<li><strong>约束</strong>：以CID为单一真实源，链上仅保存摘要/索引以验证完整性与可用性。</li>
</ul>
<h4 id="2113-nft">2.11.3 NFT元数据存储</h4>
<ul>
<li><strong>功能描述</strong>：存储NFT的元数据信息和状态</li>
<li><strong>输入</strong>：NFT属性、NFT类型全局参数配置引用（CID/版本）、中奖序号、NFT状态</li>
<li><strong>输出</strong>：元数据URI、存储确认</li>
<li><strong>约束</strong>：元数据引用配置CID作为来源，支持中奖序号关联，包含NFT状态信息</li>
</ul>
<h2 id="3">3. 非功能需求</h2>
<h3 id="31">3.1 性能需求</h3>
<ul>
<li><strong>响应时间</strong>：偏好投票操作响应时间不超过3秒</li>
<li><strong>吞吐量</strong>：支持每秒1000+并发偏好投票操作</li>
<li><strong>扩展性</strong>：支持百万级决策人规模</li>
<li><strong>可用性</strong>：系统可用性达到99.9%</li>
<li><strong>NFT类型扩展性</strong>：支持动态添加新的NFT类型而不影响系统性能</li>
<li><strong>多目标选择性能</strong>：会话创建时间 ≤ 3秒，参与者注册时间 ≤ 2秒，承诺处理时间 ≤ 5秒（1000参与者），揭示处理时间 ≤ 8秒（1000参与者），中奖计算时间 ≤ 10秒（1000参与者，10个目标）</li>
</ul>
<h3 id="32">3.2 安全需求</h3>
<ul>
<li><strong>隐私保护</strong>：偏好投票内容对第三方不可见</li>
<li><strong>数据完整性</strong>：确保偏好投票数据不被篡改</li>
<li><strong>身份验证</strong>：防止身份伪造和重复投票</li>
<li><strong>抗攻击性</strong>：抵御常见的网络攻击</li>
<li><strong>NFT状态安全</strong>：确保NFT状态变量的安全性和一致性</li>
<li><strong>自动化安全</strong>：iAgent自动化操作需要身份验证和权限验证，防止未授权访问和恶意自动化操作</li>
<li><strong>偏好保护</strong>：确保决策人的偏好值在揭示前不被泄露</li>
<li><strong>防重放攻击</strong>：防止投票被重复提交</li>
</ul>
<h3 id="33">3.3 可靠性需求</h3>
<ul>
<li><strong>容错性</strong>：系统在部分节点故障时仍能正常运行</li>
<li><strong>数据备份</strong>：关键数据多重备份</li>
<li><strong>恢复能力</strong>：系统故障后能快速恢复</li>
<li><strong>监控告警</strong>：实时监控系统状态和异常</li>
<li><strong>NFT状态一致性</strong>：确保NFT状态在所有节点间保持一致</li>
<li><strong>自动化可靠性</strong>：iAgent自动化服务具备故障转移能力，支持自动化任务的自动重试和恢复机制</li>
</ul>
<h3 id="34">3.4 兼容性需求</h3>
<ul>
<li><strong>平台兼容</strong>：支持主流操作系统和浏览器</li>
<li><strong>标准兼容</strong>：遵循相关密码学和区块链标准</li>
<li><strong>接口兼容</strong>：提供标准化的API接口</li>
<li><strong>NFT类型兼容</strong>：支持不同NFT类型之间的兼容性和互操作性</li>
</ul>
<h2 id="4">4. 系统约束</h2>
<h3 id="41">4.1 技术约束</h3>
<ul>
<li>必须使用Rust语言开发核心逻辑</li>
<li>必须使用WebAssembly技术</li>
<li>必须选择Injective或Avalanche区块链平台</li>
<li>必须实现比特承诺协议</li>
<li><strong>必须实现NFT类型控制应用场景的机制</strong></li>
<li><strong>必须实现NFT全局状态变量管理</strong></li>
</ul>
<h3 id="42">4.2 法律约束</h3>
<ul>
<li>遵守相关数据保护法规</li>
<li>确保用户隐私权</li>
<li>符合区块链相关法律法规</li>
</ul>
<h3 id="43">4.3 业务约束</h3>
<ul>
<li>系统部署成本控制在合理范围内</li>
<li>支持多语言界面</li>
<li>提供完整的审计日志</li>
<li><strong>支持NFT类型的动态扩展和升级</strong></li>
</ul>
<h2 id="5">5. 验收标准</h2>
<h3 id="51">5.1 功能验收</h3>
<ul>
<li>所有功能需求得到完整实现</li>
<li>用户界面友好易用</li>
<li>系统文档完整准确</li>
<li><strong>NFT类型控制应用场景功能正常工作</strong></li>
<li><strong>NFT分发替代用户注册功能正常工作</strong></li>
<li><strong>NFT全局状态变量控制比特承诺功能正常工作</strong></li>
<li>iAgent自动化功能正常工作，支持多种自动化策略和触发条件</li>
</ul>
<h3 id="52">5.2 性能验收</h3>
<ul>
<li>满足所有性能需求指标</li>
<li>通过压力测试验证</li>
<li>支持预期用户规模</li>
<li><strong>支持多种NFT类型的并发处理</strong></li>
<li>iAgent自动化操作响应时间满足要求，支持并发自动化任务处理</li>
<li><strong>多目标选择系统性能验收</strong>：支持10000+参与者同时参与，批量操作优化，异步处理架构</li>
</ul>
<h3 id="53">5.3 安全验收</h3>
<ul>
<li>通过安全审计</li>
<li>隐私保护机制有效</li>
<li>抗攻击能力验证</li>
<li><strong>NFT状态管理安全性得到验证</strong></li>
<li>iAgent自动化操作的安全性得到验证，防止未授权访问和恶意操作</li>
</ul>
<h2 id="6">6. 风险评估</h2>
<h3 id="61">6.1 技术风险</h3>
<ul>
<li>区块链性能瓶颈</li>
<li>密码学算法安全性</li>
<li>WebAssembly兼容性问题</li>
<li><strong>NFT类型扩展的复杂性</strong></li>
<li><strong>NFT状态管理的一致性风险</strong></li>
</ul>
<h3 id="62">6.2 业务风险</h3>
<ul>
<li>用户接受度</li>
<li>监管政策变化</li>
<li>竞争环境变化</li>
</ul>
<h3 id="63">6.3 风险缓解措施</h3>
<ul>
<li>技术方案充分验证</li>
<li>合规性持续监控</li>
<li>用户反馈及时响应</li>
<li><strong>NFT类型设计的标准化和规范化</strong></li>
<li><strong>NFT状态管理的多重验证机制</strong></li>
</ul>
</body>
</html>